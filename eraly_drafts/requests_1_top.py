import requests
from bs4 import BeautifulSoup as bs
import datetime
import logging
from fake_useragent import UserAgent
import os

# timestamp = datetime.datetime.now().strftime("%Y-%m-%d_%H-%M")
# log_file_name = f"steam_rpg_req_{timestamp}.log"
log_file_name = 'st_req.log'

if os.path.exists(log_file_name):
    os.remove(log_file_name)

logging.basicConfig(filename=log_file_name, level=logging.INFO,
                    format='%(levelname)s - %(message)s')

url = "https://store.steampowered.com/category/rpg/?flavor=contenthub_topsellers"

# Send an HTTP request to the URL
try:
    logging.info(f"Trying to retrieve steam rpg genre page from url: {url}")
    ua_random = UserAgent().random
    req_header = {'User-Agent': ua_random}
    rpgs_home = requests.get(url, headers=req_header)
    rpgs_soup = bs(rpgs_home.text, 'lxml')

    game = rpgs_soup.find('div', class_="facetedbrowse_FacetedBrowseInnerCtn_hWbTI")
    # print(game)
    print(rpgs_soup)
    # logging.info(f"{games}")
    # logging.info(f"Successfully requested steam rpg genre page from url: {url}")

# <div class="salepreviewwidgets_TitleCtn_1F4bc"><a href="https://store.steampowered.com/app/1599340/Lost_Ark?snr=1_category_4_rpg_100726" target="_blank"><div class="salepreviewwidgets_StoreSaleWidgetTitle_3jI46">Lost Ark</div></a></div>

# <div class="salepreviewwidgets_StoreSaleWidgetOuterContainer_38DqR Panel Focusable"><div class="salepreviewwidgets_StoreSaleWidgetContainer_UlvFk salepreviewwidgets_SaleItemDefaultCapsuleDisplay_34o91 Focusable" tabindex="0"><div class="salepreviewwidgets_StoreSaleWidgetHalfLeft_2Va3O"><a href="https://store.steampowered.com/app/435150/Divinity_Original_Sin_2__Definitive_Edition?snr=1_category_4_rpg_100726" target="_blank"><div class="salepreviewwidgets_StoreSaleWidgetImage_21N0p"><div class="salepreviewwidgets_CapsuleDecorators_3BjPC CapsuleDecorators"></div><div class="salepreviewwidgets_HeaderCapsuleImageContainer_Cqh49"><img class="salepreviewwidgets_CapsuleImage_cODQh" src="https://cdn.akamai.steamstatic.com/steam/apps/435150/header.jpg?t=1668591196" loading="lazy" width="460" height="215" alt="Divinity: Original Sin 2 - Definitive Edition"></div></div></a></div><div class="salepreviewwidgets_StoreSaleWidgetRight_1lRFu"><div class="gamehover_WishlistButton_1l89v gamehover_WishlistButtonNotTop_2onG_ WishlistButton"><svg height="24px" width="24px" viewBox="0 0 24 24" x="0px" y="0px"><path fill="white" d="M3.3,0.5v23h17.5v-23H3.3z M10.2,9.6l-3-2.2h3.7L12,3.9l1.2,3.6H17l-3,2.2l1.2,3.6L12,11l-3,2.2L10.2,9.6z M17.3,16.1 M17.4,18H6.6v-1.2h10.7L17.4,18L17.4,18z M17.3,19.9"></path></svg><div class="gamehover_WishlistButtonText_-ne-j">Add to wishlist</div></div><div class="salepreviewwidgets_TitleCtn_1F4bc"><a href="https://store.steampowered.com/app/435150/Divinity_Original_Sin_2__Definitive_Edition?snr=1_category_4_rpg_100726" target="_blank"><div class="salepreviewwidgets_StoreSaleWidgetTitle_3jI46">Divinity: Original Sin 2 - Definitive Edition</div></a></div><div class="salepreviewwidgets_StoreSaleWidgetReleaseAndTags_3sBHX"><div class="salepreviewwidgets_StoreSaleWidgetTags_3OSJs"><a href="https://store.steampowered.com/tags/en/Tactical%20RPG?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Tactical RPG</a><a href="https://store.steampowered.com/tags/en/RPG?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">RPG</a><a href="https://store.steampowered.com/tags/en/Turn-Based%20Strategy?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Turn-Based Strategy</a><a href="https://store.steampowered.com/tags/en/Story%20Rich?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Story Rich</a><a href="https://store.steampowered.com/tags/en/Exploration?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Exploration</a><a href="https://store.steampowered.com/tags/en/Fantasy?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Fantasy</a><a href="https://store.steampowered.com/tags/en/CRPG?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">CRPG</a><a href="https://store.steampowered.com/tags/en/Party-Based%20RPG?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Party-Based RPG</a><a href="https://store.steampowered.com/tags/en/Character%20Customization?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Character Customization</a><a href="https://store.steampowered.com/tags/en/Strategy%20RPG?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Strategy RPG</a><a href="https://store.steampowered.com/tags/en/PvP?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">PvP</a><a href="https://store.steampowered.com/tags/en/Female%20Protagonist?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Female Protagonist</a><a href="https://store.steampowered.com/tags/en/Co-op%20Campaign?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Co-op Campaign</a><a href="https://store.steampowered.com/tags/en/Local%20Co-Op?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Local Co-Op</a><a href="https://store.steampowered.com/tags/en/Isometric?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Isometric</a><a href="https://store.steampowered.com/tags/en/Romance?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Romance</a><a href="https://store.steampowered.com/tags/en/Choices%20Matter?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Choices Matter</a><a href="https://store.steampowered.com/tags/en/Strategy?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Strategy</a><a href="https://store.steampowered.com/tags/en/Moddable?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Moddable</a><a href="https://store.steampowered.com/tags/en/Funny?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Funny</a></div><div class="salepreviewwidgets_WidgetReleaseDateAndPlatformCtn_2vdJg"><div class="salepreviewwidgets_StoreSaleWidgetRelease_3eOdk">Sep 14, 2017</div><span class="salepreviewwidgets_CapsulePlatform_3vzWb"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" class="SVGIcon_Button SVGIcon_WindowsLogo" width="100%" height="100%" viewBox="0 0 128 128" enable-background="new 0 0 128 128"><rect fill="#FFFFFF" width="60.834" height="60.835"></rect><rect x="67.165" fill="#FFFFFF" width="60.835" height="60.835"></rect><rect y="67.164" fill="#FFFFFF" width="60.834" height="60.836"></rect><rect x="67.165" y="67.164" fill="#FFFFFF" width="60.835" height="60.836"></rect></svg><svg version="1.1" id="base" xmlns="http://www.w3.org/2000/svg" class="SVGIcon_Button SVGIcon_AppleLogo" x="0px" y="0px" width="256px" height="256px" viewBox="0 0 256 256"><path d="M138.365,26.557c16.139-21.272,38.578-21.376,38.578-21.376s3.336,19.999-12.696,39.266 c-17.12,20.572-36.58,17.206-36.58,17.206S124.012,45.473,138.365,26.557z"></path><path d="M129.719,75.662c8.305,0,23.713-11.413,43.771-11.413c34.527,0,48.109,24.566,48.109,24.566s-26.565,13.583-26.565,46.54 c0,37.179,33.093,49.991,33.093,49.991s-23.134,65.112-54.38,65.112c-14.353,0-25.509-9.672-40.631-9.672 c-15.41,0-30.702,10.032-40.662,10.032c-28.533,0-64.581-61.765-64.581-111.414c0-48.849,30.512-74.474,59.13-74.474 C105.61,64.933,120.047,75.662,129.719,75.662z"></path></svg></span></div><a href="https://store.steampowered.com/app/435150/?snr=1_category_4_rpg_100726#app_reviews_hash" target="_blank" class="gamehover_ReviewScore_24NyY ReviewScore Focusable" tabindex="0"><div class="gamehover_ReviewScoreValue_2SbZz gamehover_ReviewScoreHigh_1Emes"><div>Overwhelmingly Positive</div><div class="gamehover_ReviewScoreCount_1Deyv">| 138,551 User Reviews</div><div class="gamehover_ReviewScoreHeader_2SFxx"> </div></div></a></div><div class="salepreviewwidgets_StoreSaleWidgetShortDesc_VvP06 StoreSaleWidgetShortDesc">The critically acclaimed RPG that raised the bar, from the creators of Baldur's Gate 3. Gather your party. Master deep, tactical combat. Venture as a party of up to four - but know that only one of you will have the chance to become a God.</div><div class="salepreviewwidgets_StoreActionWidgetContainer_1gO7r"><div class="salepreviewwidgets_StoreSalePriceActionWidgetContainer_ztiNw"><div class="salepreviewwidgets_Action_3Af0S CartBtn"><span>Add to Cart</span></div><div class="salepreviewwidgets_StoreSalePriceWidgetContainer_tqNH0 StoreSalePriceWidgetContainer salepreviewwidgets_Discounted_35-Ub"><div class="salepreviewwidgets_StoreSaleDiscountBox_2fpFv">-60%</div><div class="salepreviewwidgets_StoreSaleDiscountedPriceCtn_3GLeQ"><div class="salepreviewwidgets_StoreOriginalPrice_1EKGZ">799 руб</div><div class="salepreviewwidgets_StoreSalePriceBox_Wh0L8">319 руб</div></div></div></div></div><div class="salepreviewwidgets_StoreSaleWidgetBgTint_1yLV1"><div class="salepreviewwidgets_HeaderCapsuleImageContainer_Cqh49"><img class="salepreviewwidgets_CapsuleImage_cODQh" src="https://cdn.akamai.steamstatic.com/steam/apps/435150/header.jpg?t=1668591196" loading="lazy" width="460" height="215" alt="Divinity: Original Sin 2 - Definitive Edition"></div></div></div></div></div>

# <div class="salepreviewwidgets_StoreSaleWidgetRight_1lRFu"><div class="gamehover_WishlistButton_1l89v gamehover_WishlistButtonNotTop_2onG_ WishlistButton"><svg height="24px" width="24px" viewBox="0 0 24 24" x="0px" y="0px"><path fill="white" d="M3.3,0.5v23h17.5v-23H3.3z M10.2,9.6l-3-2.2h3.7L12,3.9l1.2,3.6H17l-3,2.2l1.2,3.6L12,11l-3,2.2L10.2,9.6z M17.3,16.1 M17.4,18H6.6v-1.2h10.7L17.4,18L17.4,18z M17.3,19.9"></path></svg><div class="gamehover_WishlistButtonText_-ne-j">Add to wishlist</div></div><div class="salepreviewwidgets_TitleCtn_1F4bc"><a href="https://store.steampowered.com/app/435150/Divinity_Original_Sin_2__Definitive_Edition?snr=1_category_4_rpg_100726" target="_blank"><div class="salepreviewwidgets_StoreSaleWidgetTitle_3jI46">Divinity: Original Sin 2 - Definitive Edition</div></a></div><div class="salepreviewwidgets_StoreSaleWidgetReleaseAndTags_3sBHX"><div class="salepreviewwidgets_StoreSaleWidgetTags_3OSJs"><a href="https://store.steampowered.com/tags/en/Tactical%20RPG?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Tactical RPG</a><a href="https://store.steampowered.com/tags/en/RPG?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">RPG</a><a href="https://store.steampowered.com/tags/en/Turn-Based%20Strategy?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Turn-Based Strategy</a><a href="https://store.steampowered.com/tags/en/Story%20Rich?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Story Rich</a><a href="https://store.steampowered.com/tags/en/Exploration?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Exploration</a><a href="https://store.steampowered.com/tags/en/Fantasy?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Fantasy</a><a href="https://store.steampowered.com/tags/en/CRPG?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">CRPG</a><a href="https://store.steampowered.com/tags/en/Party-Based%20RPG?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Party-Based RPG</a><a href="https://store.steampowered.com/tags/en/Character%20Customization?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Character Customization</a><a href="https://store.steampowered.com/tags/en/Strategy%20RPG?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Strategy RPG</a><a href="https://store.steampowered.com/tags/en/PvP?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">PvP</a><a href="https://store.steampowered.com/tags/en/Female%20Protagonist?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Female Protagonist</a><a href="https://store.steampowered.com/tags/en/Co-op%20Campaign?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Co-op Campaign</a><a href="https://store.steampowered.com/tags/en/Local%20Co-Op?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Local Co-Op</a><a href="https://store.steampowered.com/tags/en/Isometric?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Isometric</a><a href="https://store.steampowered.com/tags/en/Romance?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Romance</a><a href="https://store.steampowered.com/tags/en/Choices%20Matter?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Choices Matter</a><a href="https://store.steampowered.com/tags/en/Strategy?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Strategy</a><a href="https://store.steampowered.com/tags/en/Moddable?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Moddable</a><a href="https://store.steampowered.com/tags/en/Funny?snr=1_category_4_rpg_100726" target="_blank" class="salepreviewwidgets_Tag_172zD WidgetTag salepreviewwidgets_AppTag_1IS0w Focusable" tabindex="0">Funny</a></div><div class="salepreviewwidgets_WidgetReleaseDateAndPlatformCtn_2vdJg"><div class="salepreviewwidgets_StoreSaleWidgetRelease_3eOdk">Sep 14, 2017</div><span class="salepreviewwidgets_CapsulePlatform_3vzWb"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" class="SVGIcon_Button SVGIcon_WindowsLogo" width="100%" height="100%" viewBox="0 0 128 128" enable-background="new 0 0 128 128"><rect fill="#FFFFFF" width="60.834" height="60.835"></rect><rect x="67.165" fill="#FFFFFF" width="60.835" height="60.835"></rect><rect y="67.164" fill="#FFFFFF" width="60.834" height="60.836"></rect><rect x="67.165" y="67.164" fill="#FFFFFF" width="60.835" height="60.836"></rect></svg><svg version="1.1" id="base" xmlns="http://www.w3.org/2000/svg" class="SVGIcon_Button SVGIcon_AppleLogo" x="0px" y="0px" width="256px" height="256px" viewBox="0 0 256 256"><path d="M138.365,26.557c16.139-21.272,38.578-21.376,38.578-21.376s3.336,19.999-12.696,39.266 c-17.12,20.572-36.58,17.206-36.58,17.206S124.012,45.473,138.365,26.557z"></path><path d="M129.719,75.662c8.305,0,23.713-11.413,43.771-11.413c34.527,0,48.109,24.566,48.109,24.566s-26.565,13.583-26.565,46.54 c0,37.179,33.093,49.991,33.093,49.991s-23.134,65.112-54.38,65.112c-14.353,0-25.509-9.672-40.631-9.672 c-15.41,0-30.702,10.032-40.662,10.032c-28.533,0-64.581-61.765-64.581-111.414c0-48.849,30.512-74.474,59.13-74.474 C105.61,64.933,120.047,75.662,129.719,75.662z"></path></svg></span></div><a href="https://store.steampowered.com/app/435150/?snr=1_category_4_rpg_100726#app_reviews_hash" target="_blank" class="gamehover_ReviewScore_24NyY ReviewScore Focusable" tabindex="0"><div class="gamehover_ReviewScoreValue_2SbZz gamehover_ReviewScoreHigh_1Emes"><div>Overwhelmingly Positive</div><div class="gamehover_ReviewScoreCount_1Deyv">| 138,551 User Reviews</div><div class="gamehover_ReviewScoreHeader_2SFxx"> </div></div></a></div><div class="salepreviewwidgets_StoreSaleWidgetShortDesc_VvP06 StoreSaleWidgetShortDesc">The critically acclaimed RPG that raised the bar, from the creators of Baldur's Gate 3. Gather your party. Master deep, tactical combat. Venture as a party of up to four - but know that only one of you will have the chance to become a God.</div><div class="salepreviewwidgets_StoreActionWidgetContainer_1gO7r"><div class="salepreviewwidgets_StoreSalePriceActionWidgetContainer_ztiNw"><div class="salepreviewwidgets_Action_3Af0S CartBtn"><span>Add to Cart</span></div><div class="salepreviewwidgets_StoreSalePriceWidgetContainer_tqNH0 StoreSalePriceWidgetContainer salepreviewwidgets_Discounted_35-Ub"><div class="salepreviewwidgets_StoreSaleDiscountBox_2fpFv">-60%</div><div class="salepreviewwidgets_StoreSaleDiscountedPriceCtn_3GLeQ"><div class="salepreviewwidgets_StoreOriginalPrice_1EKGZ">799 руб</div><div class="salepreviewwidgets_StoreSalePriceBox_Wh0L8">319 руб</div></div></div></div></div><div class="salepreviewwidgets_StoreSaleWidgetBgTint_1yLV1"><div class="salepreviewwidgets_HeaderCapsuleImageContainer_Cqh49"><img class="salepreviewwidgets_CapsuleImage_cODQh" src="https://cdn.akamai.steamstatic.com/steam/apps/435150/header.jpg?t=1668591196" loading="lazy" width="460" height="215" alt="Divinity: Original Sin 2 - Definitive Edition"></div></div></div>
except requests.exceptions.HTTPError as req_e:
    logging.error(f"Unable to request steam rpg genre page: {req_e}")


